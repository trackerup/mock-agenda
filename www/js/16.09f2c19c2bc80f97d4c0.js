webpackJsonp([16],{bLCm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),s=a.n(n),o=a("Xxa5"),r=a.n(o),i=a("exGp"),c=a.n(i),u=a("NYxO"),d=a("CgnP"),l=a("4zFs"),g=a("2hzV"),m={name:"UserDetails",data:function(){return{userMeta:null,empresaMeta:null,version:"1.21.1",termos:null,loaded:!1}},created:function(){var t=this;return c()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,e.next=3,d.a.getUserMeta([t.user.id,"matricula"]);case 3:return t.userMeta=e.sent,e.next=6,d.a.getEmpresaMeta([t.user.empresa,"CNPJ"]);case 6:return t.empresaMeta=e.sent,e.next=9,d.a.getUserMeta([t.user.id,"__user_background_accept"]);case 9:t.termos=e.sent,t.termos&&t.termos.meta_value||a.$bus.$emit("showLocationMessageEmitted",{opened:!0,msg:a.$t("Texto Termos de Localização")});case 11:case"end":return e.stop()}},e,t)}))()},computed:s()({},Object(u.b)({tasks:"task/tasks",user:"user/user",viewDate:"task/viewDate",startBackground:"user/startBackground"}),{userName:function(){return this.user?this.user.nome:""},userRegistration:function(){return this.userMeta?this.userMeta.meta_value:""},companyName:function(){return this.empresaMeta?this.empresaMeta.meta_value:""}}),methods:{listen:function(){var t=this,e=this;this.$bus.$on("startBackground-ContinueLogin",c()(r.a.mark(function a(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:console.log("Iniciando Background Geolocation e Continuando Login"),e.$geolocation.initGeolocation(e,window.BackgroundGeolocation),"true"===e.startBackground&&e.$bus.$emit("startBackground",!0);case 3:case"end":return t.stop()}},a,t)})))},continueLogin:function(){var t=this;return c()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,t.$bus.$emit("auth-user",!0),t.$bus.$emit("tasks-sync",!0),e.next=5,t.$store.dispatch("task/getTasks",{});case 5:Object(g.c)({act:"initRastreamento"}),a.$geolocation.initGeolocation(a,window.BackgroundGeolocation),a.$geolocation.startBackground(a),window.cordova.plugins.backgroundMode.enable(),Object(l.b)(t.user).then(function(t){t.data;console.log("Inicio Rastreamento"),a.tasks.travelStarted.length&&"iOS"==window.jscd.os?(window.cordova.plugins.backgroundMode.enable(),window.BackgroundGeolocation.changePace(!0)):window.BackgroundGeolocation.changePace(!1)}).catch(function(e){var a=e.data;t.error=t.$t(a.error);var n={message:t.$t(t.error)};t.$bus.$emit("showSnackBar",n)}),t.$emit("authenticated",!0),t.$router.push("/tasks"),Object(g.d)();case 13:case"end":return e.stop()}},e,t)}))()},unsaveLogin:function(){var t=this;return c()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.$geolocation.stopBackground(t),e.next=3,t.$store.dispatch("user/logout");case 3:t.$router.push("/login"),t.$bus.$emit("auth-user",!1);case 5:case"end":return e.stop()}},e,t)}))()}},mounted:function(){var t=this;this.listen(),this.$geolocation?(this.$geolocation.getStatusGeolocation().then(function(e){e?t.continueLogin():t.loaded=!0}),setTimeout(function(){t.loaded=!0},3e3)):t.loaded=!0},destroyed:function(){this.$bus.$off("startBackground-ContinueLogin")}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-container user-details",attrs:{id:"app"}},[n("div",{staticClass:"mdl-app"},[n("div",{staticClass:"mdl-app-content"},[n("div",{staticClass:"logo"},[t.user&&t.user.theme&&t.user.theme.logo?n("img",{attrs:{src:t.user.theme.logo}}):n("img",{attrs:{src:a("jkwb")}})]),t._v(" "),n("div",{staticClass:"centered-container saved"},[n("div",{staticClass:"mdl-content"},[n("h4",[t._v(t._s(t.userName))]),t._v(" "),n("div",{staticClass:"user-info"},[t._v("\n              "+t._s(t.userRegistration)+"\n              "),n("br"),t._v("\n              "+t._s(t.companyName)+"\n          ")]),t._v(" "),t.loaded?[n("h5",[t._v(t._s(t.$t("Iniciar Rastreamento")))]),t._v(" "),n("button",{staticClass:"mdl-button mdl-button--fab orange",on:{click:t.continueLogin}},[n("i",{staticClass:"material-icons arrow-right"},[t._v("keyboard_arrow_right")])])]:t._e(),t._v(" "),n("p",[t._v(t._s(t.version))])],2)])])])])},staticRenderFns:[]};var h=a("VU/8")(m,v,!1,function(t){a("phOv")},"data-v-3fbf34c6",null);e.default=h.exports},phOv:function(t,e){}});
//# sourceMappingURL=16.09f2c19c2bc80f97d4c0.js.map