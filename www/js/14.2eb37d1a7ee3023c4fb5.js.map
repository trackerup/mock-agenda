{"version":3,"sources":["webpack:///./src/plugins/persistence/entities/formsCategory.js","webpack:///src/pages/tasks/Occurrence.vue","webpack:///./src/pages/tasks/Occurrence.vue?5793","webpack:///./src/pages/tasks/Occurrence.vue"],"names":["formsCategory","getters","getAll","Occurrence","name","components","Form","data","forms","formsCategoryMeta","value","occurenceDialog","opened","form","task","currentResponse","formValues","computed","extends_default","Object","vuex_esm","currentTask","coords","user","beforeMount","_this","this","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","getForms","getFormsCategory","stop","mounted","_self","$emit","pageTitle","$t","mapMenu","backMenu","window","localStorage","getItem","_idForm","then","values_default","find","id","JSON","parse","watch","currentRoute","current","checkRoute","handler","val","$el","querySelector","showModal","close","deep","methods","_ref","_this2","promise_default","_callee2","resolve","reject","_context2","entities_forms","getAllForms","_x","_x2","apply","arguments","_this3","_callee3","_context3","sent","processaForms","t0","console","log","map","category","ativo","filter","meta","idCategoria","idFormulario","titulo","toLowerCase","indexOf","length","formsSemCategory","push","nome","$forceUpdate","openFormsAccordeon","selectCategory","status","onInput","e","clear","setFormOccurence","_this4","_callee4","_context4","removeItem","setItem","updateForm","values","stringify_default","saveResponseOccurence","_this5","_callee5","_form","_context5","tarefa","$bus","msg","setTimeout","clearOccurenceData","cancelResponseOccurence","deleteTemporaryTask","$router","thisTask","assign_default","beforeDestroy","$store","dispatch","tasks_Occurrence","render","_vm","_h","$createElement","_c","staticClass","_v","directives","rawName","class","is-dirty","expression","attrs","type","domProps","on","input","$event","target","composing","_m","click","_l","index","key","_s","_e","ref","idForm","typeForm","save","cancel","staticRenderFns","for","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"js/14.2eb37d1a7ee3023c4fb5.js","sourcesContent":["import { getters, setters } from '@/plugins/persistence/services'\r\n// import store from '@/store/'\r\n\r\nexport default {\r\n  async insertFormCategory (category) {\r\n    await setters.setOne('form_categorias', category)\r\n  },\r\n  getAllFormsCategory () {\r\n    return getters.getAll('form_categorias')\r\n  },\r\n  saveFormsCategoryPosSync (listaFormsCategory) {\r\n    return new Promise(async (resolve, reject) => {\r\n      if (listaFormsCategory.length > 0) {\r\n        for (let index = 0; index < listaFormsCategory.length; index++) {\r\n          getters.getOne('form_resposta', listaFormsCategory[index]).then(function (responseToUpdate) {\r\n            responseToUpdate['sinc'] = 1\r\n            setters.setOne('form_categorias', responseToUpdate)\r\n          })\r\n        }\r\n      }\r\n      resolve(listaFormsCategory)\r\n    })\r\n  },\r\n  async insertFormMetaCategory (meta) {\r\n    await setters.setOne('form_meta_categorias', meta)\r\n  },\r\n  getAllFormsMetaCategory () {\r\n    return getters.getAll('form_meta_categorias')\r\n  },\r\n  saveFormsMetaCategoryPosSync (listaFormsMetaCategory) {\r\n    return new Promise(async (resolve, reject) => {\r\n      if (listaFormsMetaCategory.length > 0) {\r\n        for (let index = 0; index < listaFormsMetaCategory.length; index++) {\r\n          getters.getOne('form_resposta', listaFormsMetaCategory[index]).then(function (responseToUpdate) {\r\n            responseToUpdate['sinc'] = 1\r\n            setters.setOne('form_categorias', responseToUpdate)\r\n          })\r\n        }\r\n      }\r\n      resolve(listaFormsMetaCategory)\r\n    })\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/plugins/persistence/entities/formsCategory.js","<template>\r\n  <div class=\"page-occurrence\">\r\n    <div class=\"mdl-app-content\">\r\n      <h6>Escolha qual Formulario melhor atende a sua Ocorrência</h6>\r\n\r\n      <div v-mdl class=\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label textfield-with-icon\" :class=\"[{'is-dirty': value != ''}]\">\r\n        <input class=\"mdl-textfield__input\"\r\n              v-on:input=\"onInput\"\r\n              type=\"text\"\r\n              v-model=\"value\"\r\n              id=\"pesquisar\">\r\n        <label class=\"mdl-textfield__label\" for=\"pesquisar\" ><span>Pesquisar</span></label>\r\n        <i class=\"material-icons mdl-textfield__label__icon reorder clearicon\" v-show=\"value != ''\" @click=\"clear\">close</i>\r\n        <i class=\"material-icons mdl-textfield__label__icon reorder\" v-show=\"value == ''\">search</i>\r\n      </div>\r\n\r\n      <div class=\"accordeon\">\r\n        <template v-for=\"(category, index) in formsCategory\">\r\n          <div class=\"painel\" :class=\"[category.ativo ? 'painel--ativo' : '']\"  v-if=\"category.forms && category.forms.length\"  :key=\"index\">\r\n            <div class=\"painel__title\" @click=\"openFormsAccordeon(category)\">\r\n              <span>{{category.nome}}</span>\r\n              <i class=\"material-icons\" v-if=\"category.ativo\">\r\n                keyboard_arrow_up\r\n              </i>\r\n              <i class=\"material-icons\" v-else>\r\n                keyboard_arrow_down\r\n              </i>\r\n            </div>\r\n              <div class=\"painel__content\" v-show=\"category.ativo\">\r\n                <ul class=\"painel__list mdl-list\">\r\n                  <li class=\"mdl-list__item\" v-for=\"(form, index) in category.forms\" :key=\"index\" @click=\"setFormOccurence(form)\">\r\n                    <span class=\"mdl-list__item-primary-content\">\r\n                      {{form.titulo}}\r\n                    </span>\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n          </div>\r\n         </template>\r\n      </div>\r\n    </div>\r\n    <dialog class=\"mdl-dialog full\" id=\"dialog-occurence\" v-show=\"occurenceDialog.opened\">\r\n      <div class=\"mdl-dialog__content\">\r\n        <h5 class=\"mdl-dialog__title\" v-if=\"form && form.titulo\">{{ $t(form.titulo) }}</h5>\r\n        <div class=\"inResponse\">\r\n            <Form\r\n              v-if=\"form\"\r\n              :idForm=\"form.id\"\r\n              :typeForm=\"'simple'\"\r\n              v-on:save=\"saveResponseOccurence\"\r\n              v-on:cancel=\"cancelResponseOccurence\"\r\n              v-on:input=\"updateForm\"\r\n              :value=\"formValues\"\r\n              ref=\"occurrenceForm\"\r\n            />\r\n        </div>\r\n      </div>\r\n    </dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n\r\nimport formsEntity from '@/plugins/persistence/entities/forms'\r\nimport formsCategoryEntity from '@/plugins/persistence/entities/formsCategory'\r\nimport { newOccurrence, deleteTaskById } from '../../plugins/persistence/entities/tarefa'\r\nimport Form from '@/components/form/Form'\r\nimport { mapGetters } from 'vuex'\r\n\r\nexport default {\r\n  name: 'Occurrence',\r\n  components: {\r\n    Form\r\n  },\r\n  data () {\r\n    return {\r\n      forms: [],\r\n      formsCategory: [],\r\n      formsCategoryMeta: [],\r\n      value: '',\r\n      occurenceDialog: {\r\n        opened: false\r\n      },\r\n      form: false,\r\n      task: null,\r\n      currentResponse: null,\r\n      formValues: null\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters({\r\n      currentTask: 'task/currentTask',\r\n      coords: 'user/coords',\r\n      user: 'user/user'\r\n    })\r\n  },\r\n  async beforeMount () {\r\n    await this.getForms()\r\n    await this.getFormsCategory()\r\n  },\r\n  mounted () {\r\n    const _self = this\r\n    this.$emit('changeParams', {\r\n      pageTitle: (this.$t('Ocorrência')),\r\n      mapMenu: false,\r\n      backMenu: true\r\n    })\r\n    if (window.localStorage.getItem('__current_form_occurrence')) {\r\n      // restaura a ocorrencia\r\n      const _idForm = window.localStorage.getItem('__current_form_occurrence')\r\n      this.getForms().then(forms => {\r\n        _self.form = Object.values(forms).find(form => { return form.id == _idForm })\r\n        _self.formValues = JSON.parse(window.localStorage.getItem('__current_response_occurrence'))\r\n        _self.occurenceDialog.opened = true\r\n      })\r\n    }\r\n  },\r\n  watch: {\r\n    currentRoute (current) {\r\n      this.checkRoute(current)\r\n    },\r\n    occurenceDialog: {\r\n      handler: function (val) {\r\n        if (val.opened) {\r\n          this.$el.querySelector('#dialog-occurence').showModal()\r\n        } else {\r\n          this.$el.querySelector('#dialog-occurence').close()\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    getForms () {\r\n      const _self = this\r\n      return new Promise(async (resolve, reject) => {\r\n        formsEntity.getAllForms().then(forms => {\r\n          _self.forms = forms\r\n          resolve(_self.forms)\r\n        })\r\n      })\r\n    },\r\n    async getFormsCategory () {\r\n      this.formsCategory = []\r\n      try {\r\n        // let taskForms = JSON.parse(this.task.forms)\r\n        this.formsCategory = await formsCategoryEntity.getAllFormsCategory()\r\n        this.formsCategoryMeta = await formsCategoryEntity.getAllFormsMetaCategory()\r\n        this.processaForms()\r\n      } catch (err) {\r\n        console.log(err)\r\n      }\r\n    },\r\n    processaForms () {\r\n      let _self = this\r\n      this.formsCategory.map((category) => {\r\n        category.ativo = false\r\n        category.forms = []\r\n        category.forms = _self.forms.filter((form) => {\r\n          return _self.formsCategoryMeta.filter((meta) => {\r\n            if (meta.idCategoria == category.id && meta.idFormulario == form.id) {\r\n              if (_self.value != '') {\r\n                if (form.titulo.toLowerCase().indexOf(_self.value.toLowerCase()) == 0) {\r\n                  return true\r\n                }\r\n              } else {\r\n                return true\r\n              }\r\n              return false\r\n            }\r\n            return false\r\n          }).length\r\n          // return option.titulo.indexOf(this.value) > -1\r\n        })\r\n      })\r\n      let formsSemCategory = this.forms.filter((form) => {\r\n        if (_self.value != '') {\r\n          if (form.titulo.toLowerCase().indexOf(_self.value.toLowerCase()) >= 0) {\r\n            return true\r\n          } else {\r\n            return false\r\n          }\r\n        } else {\r\n          return true\r\n        }\r\n        // return option.titulo.indexOf(this.value) > -1\r\n      })\r\n      if (formsSemCategory.length) {\r\n        this.formsCategory.push(\r\n          {\r\n            'nome': 'Formulários',\r\n            'forms': formsSemCategory\r\n          }\r\n        )\r\n      }\r\n      this.$forceUpdate()\r\n    },\r\n    openFormsAccordeon (selectCategory) {\r\n      let status = selectCategory.ativo\r\n      this.formsCategory.map((category) => {\r\n        category.ativo = false\r\n      })\r\n      selectCategory.ativo = !status\r\n      this.$forceUpdate()\r\n      // window.componentHandler.upgradeDom()\r\n    },\r\n    onInput (e) {\r\n      this.processaForms()\r\n      this.$forceUpdate()\r\n    },\r\n    clear () {\r\n      this.value = ''\r\n      this.processaForms()\r\n      this.$forceUpdate()\r\n    },\r\n    async setFormOccurence (form) {\r\n      this.form = form\r\n      window.localStorage.removeItem('__current_response_occurrence')\r\n      window.localStorage.setItem('__current_form_occurrence', form.id)\r\n      this.occurenceDialog.opened = true\r\n    },\r\n    updateForm (values) {\r\n      window.localStorage.setItem('__current_response_occurrence', JSON.stringify(values))\r\n    },\r\n    async saveResponseOccurence (values) {\r\n      newOccurrence(this.user, this.form, this.coords, values)\r\n      window.localStorage.removeItem('__current_response_occurrence')\r\n      this.$bus.$emit('showMessageEmitted', {\r\n        msg: this.$t('Ocorrência salva com sucesso!')\r\n      })\r\n      this.formValues = null\r\n      let _form = this.form\r\n      this.form = null\r\n      setTimeout(() => {\r\n        this.form = _form\r\n      }, 50)\r\n    },\r\n    clearOccurenceData () {\r\n      this.form = null\r\n      this.occurenceDialog.opened = false\r\n      window.localStorage.removeItem('__current_response_occurrence')\r\n      window.localStorage.removeItem('__current_form_occurrence')\r\n    },\r\n    cancelResponseOccurence () {\r\n      this.clearOccurenceData()\r\n      this.deleteTemporaryTask()\r\n      this.$router.push('/tasks')\r\n    },\r\n    deleteTemporaryTask () {\r\n      let thisTask = Object.assign({}, this.currentTask)\r\n      deleteTaskById(thisTask.id)\r\n    }\r\n  },\r\n  beforeDestroy () {\r\n    this.$store.dispatch('task/setCurrentTask', {task: null})\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.mdl-app-content {\r\n  height: auto;\r\n  min-height:100%;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/pages/tasks/Occurrence.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page-occurrence\"},[_c('div',{staticClass:\"mdl-app-content\"},[_c('h6',[_vm._v(\"Escolha qual Formulario melhor atende a sua Ocorrência\")]),_vm._v(\" \"),_c('div',{directives:[{name:\"mdl\",rawName:\"v-mdl\"}],staticClass:\"mdl-textfield mdl-js-textfield mdl-textfield--floating-label textfield-with-icon\",class:[{'is-dirty': _vm.value != ''}]},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.value),expression:\"value\"}],staticClass:\"mdl-textfield__input\",attrs:{\"type\":\"text\",\"id\":\"pesquisar\"},domProps:{\"value\":(_vm.value)},on:{\"input\":[function($event){if($event.target.composing){ return; }_vm.value=$event.target.value},_vm.onInput]}}),_vm._v(\" \"),_vm._m(0),_vm._v(\" \"),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.value != ''),expression:\"value != ''\"}],staticClass:\"material-icons mdl-textfield__label__icon reorder clearicon\",on:{\"click\":_vm.clear}},[_vm._v(\"close\")]),_vm._v(\" \"),_c('i',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.value == ''),expression:\"value == ''\"}],staticClass:\"material-icons mdl-textfield__label__icon reorder\"},[_vm._v(\"search\")])]),_vm._v(\" \"),_c('div',{staticClass:\"accordeon\"},[_vm._l((_vm.formsCategory),function(category,index){return [(category.forms && category.forms.length)?_c('div',{key:index,staticClass:\"painel\",class:[category.ativo ? 'painel--ativo' : '']},[_c('div',{staticClass:\"painel__title\",on:{\"click\":function($event){return _vm.openFormsAccordeon(category)}}},[_c('span',[_vm._v(_vm._s(category.nome))]),_vm._v(\" \"),(category.ativo)?_c('i',{staticClass:\"material-icons\"},[_vm._v(\"\\n              keyboard_arrow_up\\n            \")]):_c('i',{staticClass:\"material-icons\"},[_vm._v(\"\\n              keyboard_arrow_down\\n            \")])]),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(category.ativo),expression:\"category.ativo\"}],staticClass:\"painel__content\"},[_c('ul',{staticClass:\"painel__list mdl-list\"},_vm._l((category.forms),function(form,index){return _c('li',{key:index,staticClass:\"mdl-list__item\",on:{\"click\":function($event){return _vm.setFormOccurence(form)}}},[_c('span',{staticClass:\"mdl-list__item-primary-content\"},[_vm._v(\"\\n                    \"+_vm._s(form.titulo)+\"\\n                  \")])])}),0)])]):_vm._e()]})],2)]),_vm._v(\" \"),_c('dialog',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.occurenceDialog.opened),expression:\"occurenceDialog.opened\"}],staticClass:\"mdl-dialog full\",attrs:{\"id\":\"dialog-occurence\"}},[_c('div',{staticClass:\"mdl-dialog__content\"},[(_vm.form && _vm.form.titulo)?_c('h5',{staticClass:\"mdl-dialog__title\"},[_vm._v(_vm._s(_vm.$t(_vm.form.titulo)))]):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"inResponse\"},[(_vm.form)?_c('Form',{ref:\"occurrenceForm\",attrs:{\"idForm\":_vm.form.id,\"typeForm\":'simple',\"value\":_vm.formValues},on:{\"save\":_vm.saveResponseOccurence,\"cancel\":_vm.cancelResponseOccurence,\"input\":_vm.updateForm}}):_vm._e()],1)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('label',{staticClass:\"mdl-textfield__label\",attrs:{\"for\":\"pesquisar\"}},[_c('span',[_vm._v(\"Pesquisar\")])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-bfbd4336\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/pages/tasks/Occurrence.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-bfbd4336\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Occurrence.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Occurrence.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Occurrence.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-bfbd4336\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Occurrence.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-bfbd4336\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/pages/tasks/Occurrence.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}